# UnoEngine Editor UI 設計仕様書

## 概要
Unity風のエディタUIを目指し、使いやすく機能的なゲームエンジンエディタを設計する。

## 目的・用途
- チーム開発対応
- 個人学習・実験用
- ゲームエンジン開発の学習

---

## View システム設計

### 1. Scene/Game View タブ切り替え方式
**現状**: Debug ViewとGame Viewを常時並列表示（2回描画でパフォーマンス負荷）

**改善案**:
- Unity風のタブ切り替え方式に変更
- 同時に1つのViewのみ描画（パフォーマンス改善）
- オンデマンド描画：操作時のみ更新、静止時は更新停止

```
┌─────────────────────────────────────────┐
│ [Scene] [Game]  ← タブで切り替え        │
├─────────────────────────────────────────┤
│                                         │
│         アクティブなViewのみ描画         │
│                                         │
└─────────────────────────────────────────┘
```

### 2. Play/Edit モード（必須）
- **Edit モード**: シーン編集可能、Game Viewは静止
- **Play モード**: ゲーム実行、編集は制限
- 再生ボタン（▶）、一時停止（⏸）、ステップ（⏭）

---

## カメラ操作システム

### 必要な機能（すべて実装）
1. **フリーカメラ**: WASD + マウスで自由移動
2. **オービットカメラ**: 中マウスドラッグでオブジェクト中心に回転
3. **フォーカス機能**: Fキーで選択オブジェクトにズーム
4. **複数カメラプリセット**: カメラアングルを保存/呼び出し

### 操作マッピング案
| 操作 | 機能 |
|------|------|
| 右クリック + WASD | フリーカメラ移動 |
| 中クリック + ドラッグ | パン移動 |
| Alt + 左ドラッグ | オービット回転 |
| スクロール | ズーム |
| F | 選択オブジェクトにフォーカス |
| Ctrl + 1-9 | カメラプリセット呼び出し |

---

## デバッグ情報表示

### 1. レイヤー切り替え（個別トグル）
- [ ] ボーン表示
- [ ] ワイヤーフレーム
- [ ] コライダー表示
- [ ] ライト範囲表示
- [ ] グリッド表示

### 2. オーバーレイ統計
- Draw Call数
- トライアングル数
- メモリ使用量
- バッチ数

### 3. オブジェクトフィルタ
- タイプ別フィルタ（メッシュ/ライト/カメラ等）
- タグ別フィルタ

### 4. リアルタイムグラフ
- FPS履歴グラフ（既存を拡張）
- CPU/GPU時間グラフ
- メモリ使用量推移

---

## Hierarchy パネル

### 必要機能
1. **ドラッグ&ドロップ**: 親子関係をドラッグで変更
2. **右クリックメニュー**: 複製/削除/名前変更
3. **表示/非表示トグル**: 👁アイコンで個別切り替え

### UI構造
```
▼ Root
  👁 ▼ Player
      👁 Mesh
      👁 Camera
  👁 ▼ Environment
      👁 Ground
      👁 Light
```

---

## Inspector パネル

### 編集可能コンポーネント
1. **Transform**: Position/Rotation/Scale の数値入力
2. **Material**: 色、テクスチャ、シェーダーパラメータ
3. **Custom Component**: ユーザー定義コンポーネント

### ギズモ実装
**参考ライブラリ**:
- https://github.com/Ka1serM/ImViewGuizmo
- https://github.com/Half-People/ImGui-2D-HArrow

ImGuiベースで3Dギズモを実装（移動/回転/スケール）

---

## Project パネル（アセットブラウザ）

### 必要機能
1. **ドラッグ&ドロップ配置**: アセットをシーンにドラッグで配置
2. **インポート機能**: 新規アセットのインポート

### 対応アセットタイプ
- モデル (.fbx, .obj, .gltf)
- テクスチャ (.png, .jpg, .dds)
- シーン (.json)
- マテリアル

---

## シーン保存/ロード

### 形式: JSON
**理由**: 
- 読みやすさ重視
- Gitとの相性が良い
- テキストエディタで編集可能

### 保存内容
```json
{
  "scene_name": "MainScene",
  "objects": [
    {
      "name": "Player",
      "transform": { "position": [0,0,0], "rotation": [0,0,0], "scale": [1,1,1] },
      "components": [...],
      "children": [...]
    }
  ],
  "settings": {
    "camera_presets": [...],
    "lighting": {...}
  }
}
```

---

## ホットキー（優先度: 高）

### 基本操作
| キー | 機能 |
|------|------|
| Ctrl + S | シーン保存 |
| Ctrl + Z | Undo |
| Ctrl + Y | Redo |
| Ctrl + D | 複製 |
| Delete | 削除 |
| F | フォーカス |
| W | 移動ギズモ |
| E | 回転ギズモ |
| R | スケールギズモ |
| Space | Play/Pause切り替え |

---

## Undo/Redo システム（次フェーズ）

### 設計方針
- Command パターンで実装
- 操作履歴をスタックで管理
- Transform変更、オブジェクト追加/削除を対象

---

## 実装優先度

### Phase 1（基盤）
1. タブ切り替えView
2. Play/Editモード
3. 基本カメラ操作（フリーカメラ）
4. ホットキーシステム

### Phase 2（編集機能）
1. ギズモ実装（ImViewGuizmo統合）
2. Inspector編集機能拡張
3. Hierarchy ドラッグ&ドロップ
4. シーン保存/ロード（JSON）

### Phase 3（高度な機能）
1. Undo/Redo
2. オービットカメラ/カメラプリセット
3. デバッグオーバーレイ拡張
4. アセットインポート

### Phase 4（ポリッシュ）
1. パフォーマンス最適化
2. UIテーマ/カスタマイズ
3. ドキュメント整備

---

## 参考リソース
- ImViewGuizmo: https://github.com/Ka1serM/ImViewGuizmo
- ImGui-2D-HArrow: https://github.com/Half-People/ImGui-2D-HArrow
